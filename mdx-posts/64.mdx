---
title: "داده کاوی - ۴ - معیار‌های فاصله"
date: "2020-04-12T13:22:41.736Z"
summary: "شرح معیار‌های فاصله و پیاده‌سازی آنها در پایتون"
tags: ["داده کاوی", "پایتون"]
category: "داده کاوی در پایتون"
image: "1399/1/4/cbc85a18-e048-4929-beb2-5fcd6412ee3f.jpeg"
---

<h4>فاصله‌ها و شباهت‌ها</h4>
<p>فاصله‌ها و شباهت‌های اشیاء که با مقایسه ویژگی‌های آنها بدست می‌آید از دسته شاخص‌های پرکاربرد در روش‌های مختلف داده کاوی هستن. معیار فاصله با معیار شباهت رابطه عکس دارد بطوریکه هر چه فاصله بیشتر باشد آن‌ها از هم دورتر بوده و شباهت آنها کمتر است و برعکس.</p><p>&nbsp;</p><h4>شرح یک مسئله</h4><p>فرض کنید می‌خواهیم میزان فاصله یا شباهت سلیقه افراد در فیلم‌ها را با داشتن امتیازاتی که برای آنها ثبت کردن محاسبه کنیم. برای این منظور می‌توانیم از روش‌های محاسبه فاصله‌ها و شباهت‌هایی که در حوزه‌ی داده‌کاوی مطرح است استفاده‌کنیم.</p><p><i>
<strong>یاد‌آوری:</strong> همانطور که در قسمت </i><a href="https://www.berneti.ir/63/%D8%AF%D8%A7%D8%AF%D9%87-%DA%A9%D8%A7%D9%88%DB%8C-%D8%AF%D8%B1-%D9%BE%D8%A7%DB%8C%D8%AA%D9%88%D9%86-%D9%82%D8%B3%D9%85%D8%AA-%DB%B2-%D9%81%D8%A7%D8%B5%D9%84%D9%87-%D9%87%D8%A7-%D9%88-%D8%B4%D8%A8%D8%A7%D9%87%D8%AA-%D9%87%D8%A7"><i>جزئیات دیتاست‌ها</i></a><i> گفته شد، دیتاست مورد استفاده movie_rating_simple بصورت زیر است.</i></p>

<figure className="image"><img src="/img/distance-1.png" /><figcaption>&nbsp;<strong>movieratings_simple.json</strong></figcaption></figure>

<h4>فاصله‌ها</h4><p>در این قسمت به شرح انواع «معیار‌های فاصله» یا <strong>Distance Metrics</strong> که برای محاسبه <strong>فاصله</strong> دو شیئ یا به عبارتی میزان دور بودن آنها استفاده می‌شود، بپردازیم.</p><p>شرایط معیارهای فاصله<br />۱ـ اندازه فاصله همیشه نامنفی است.<br />۲ـ اگر فاصله‌ی بین دو نقطه صفر باشد آن دو نقطه یکی هستن و بر عکس.<br />۳ـ در صورت جابجایی مبدا و مقصد بین دو نقطه‌ی ثابت فاصله‌ها به یک اندازه باشند.</p>

```math
F(a,b) = F(b,a)
```

<p>۴ـ نامساوی مثلثی، صادق باشد مطابق شکل زیر برای هر سه نقطه‌ی دلخواه</p>

<figure className="image image_resized" style={{"width":"69.06%"}}><img src="/img/distance-2.jpeg" /></figure>
<p>
<i>*یادآوری: نامساوی مثلثی بیان می‌کند مجموع دو طول یک مثلث بزرگتر از ضلع سوم آن است.</i>
</p>

<h4>&nbsp;</h4><h4>فاصله اقلیدسی</h4><p>فاصله‌ی اقلیدسی مانند قضیه فیثاغورس برابر است با ریشه دوم مجموع مربعات اختلاف ویژگی‌های اشیاء</p>

```math
f(q,p) = \sqrt{(q_1-p_1)^2+\cdots+(q_n-p_n)^2}\\= \sqrt{\sum_{i=1}^{n}(q_i-p_i)^2}
```

<p><strong>به مثال زیر که در ادامه برای فاصله‌های دیگر نیز بررسی می‌کنیم دقت کنید.</strong></p>

<figure className="image image_resized" style={{"width":"64.32%"}}><img src="/img/distance-3.jpeg" /></figure>

<p>&nbsp;</p><h4>&nbsp;پیاده‌سازی روش اقلیدسی در پایتون</h4>

```python
def get_euclidean_distance(rating1,rating2):
    distance = 0
    for key in rating1:
        if key in rating2:
            distance += pow(abs(rating1[key]-rating2[key]), 2)
    return pow(distance, 1/2)

dt=movie_rating_simple_dict

print('abbas-hasan:%f'%+get_euclidean_distance(dt['abbas'],dt['hasan']))
print('abbas-alireza:%f'%get_euclidean_distance(dt['abbas'],dt['alireza']))
print('abbas-mahdi:%f'%+get_euclidean_distance(dt['abbas'],dt['mahdi']))
print('abbas-saeed:%f'%+get_euclidean_distance(dt['abbas'],dt['saeed']))

// result ---------------
// abbas-hasan:3.162278
// abbas-alireza:1.000000
// abbas-mahdi:1.414214
// abbas-saeed:2.236068 
```

<h4>فاصله منهتن یا فاصله‌ی راننده تاکسی</h4>

<figure className="image image_resized" style={{"width":"51.67%"}}><img src="/img/distance-4.jpeg" /></figure>

<a href="https://tasks.illustrativemathematics.org/content-standards/tasks/1417">illustrativemathematics</a>

<p><i>خط آبی نشان دهنده‌ی فاصله‌ی راننده‌ تاکسی یا منهتن، بین دو نقطه‌ی Start و End است و خط قرمز نشان دهنده‌ی فاصله‌ی اقلیدوسی می‌باشد.</i></p>

<p>فاصله‌ی منهتن ساده‌ترین معیار برای محاسبه‌ی فاصله است که برابر است با مجموع قدر مطلق اختلاف ویژگی‌های اشیاء.</p>

<h4>&nbsp;</h4><h4>محاسبه‌ی فاصله به روش منهتن</h4>

<figure className="image image_resized" style={{"width":"63.63%"}}><img src="/img/distance-5.jpeg" /></figure>

<p>&nbsp;</p><h4>پیاده‌سازی روش منهتن در پایتون</h4>

```python
def get_manhattan_distance(rating1,rating2):
    distance = 0
    for key in rating1:
        if key in rating2:
            distance += abs(rating1[key] - rating2[key])
    return distance

dt=movie_rating_simple_dict

print('abbas-hasan:%s'%+get_manhattan_distance(dt['abbas'],dt['hasan']))
print('abbas-alireza:%s'%get_manhattan_distance(dt['abbas'],dt['alireza']))
print('abbas-mahdi:%s'%+get_manhattan_distance(dt['abbas'],dt['mahdi']))
print('abbas-saeed:%s'%+get_manhattan_distance(dt['abbas'],dt['saeed']))

// result ------------------
// abbas-hasan:4
// abbas-alireza:1
// abbas-mahdi:2
// abbas-saeed:3
```

<p>&nbsp;</p><h4>فاصله چبیشف</h4>

<p>یا به عبارتی دیگر فاصله‌ی چبیشف برابر است با حداکثر اختلافی که بین ویژگی‌های اشیاء وجود دارد.</p>
<h4><strong>محاسبه‌ی فاصله به روش چبیشف</strong></h4>

<figure className="image image_resized" style={{"width":"59.64%"}}><img src="/img/distance-6.jpeg" /></figure>

<h4>&nbsp;</h4><h4>پیاده‌سازی روش چبیشف در پایتون</h4>

```python
def get_chebychev_distance(rating1,rating2):
    distance = 0
    for key in rating1:
        if key in rating2:
            candidate_distance = abs(rating1[key] - rating2[key])
            if(candidate_distance>distance):
                distance = candidate_distance            
    return distance

dt=movie_rating_simple_dict

print('abbas-hasan:%s'%+get_chebychev_distance(dt['abbas'],dt['hasan']))
print('abbas-alireza:%s'%get_chebychev_distance(dt['abbas'],dt['alireza']))
print('abbas-mahdi:%s'%+get_chebychev_distance(dt['abbas'],dt['mahdi']))
print('abbas-saeed:%s'%+get_chebychev_distance(dt['abbas'],dt['saeed']))

// result ---------------
// abbas-hasan:3
// abbas-alireza:1
// abbas-mahdi:1
// abbas-saeed:2
```

<h4>فاصله مینکوفسکی</h4>
<p>یک معیار کلی و تعمیم یافته است، به این معنا که می‌توان با تغییر فرمول فاصله‌های متفاوتی را محاسبه کرد.</p>

```math
({\sum_{i=1}^{n}{\left | x_i-y_i \right | }^p})^{^1/_p}  
```

<p>برای مثال با تغییر مقدار p در معادله‌ی فوق به سه فاصله‌ی متفاوت زیر می‌رسیم.</p><p>اگر بجای p عدد ۱ را قرار دهیم، تبدیل به فاصله‌ی منهتن می‌شود.</p><p>اگر بجای p عدد ۲ را قرار دهیم، تبدیل به فاصله‌ی اقلیدسی می‌شود.</p><p>اگر بجای p عدد ∞ (یا بینهایت) را قرار دهیم، تبدیل به فاصله‌ی چبیشف می‌شود.</p><p><strong>** نکته: هر چه p بزرگتر باشد، میزان تاثیر اختلاف زیاد در یک ویژگی روی نتیجه بیشتر خواهد شد.</strong></p>

<h4>پیاده‌سازی روش مینکوفسکی در پایتون</h4>

```python
def get_minkowski_distance(rating1, rating2, q):
    distance = 0
    commonRatings = False
    for key in rating1:
        if key in rating2:
            distance += pow(abs(rating1[key]-rating2[key]), q)
            commonRatings = True
    if(commonRatings):
        return pow(distance, 1/q)
    else:
        return 0
        
dt=movie_rating_simple_dict

print('q=1 abbas-hasan:%f'%get_minkowski_distance(dt['abbas'],dt['hasan'],1))
print('q=2 abbas-hasan:%f'%+get_minkowski_distance(dt['abbas'],dt['hasan'],2))
print('q=3 abbas-hasan:%f'%+get_minkowski_distance(dt['abbas'],dt['hasan'],300))

// result -------------------------
// q=1 abbas-hasan:4.000000
// q=2 abbas-hasan:3.162278
// q=3 abbas-hasan:3.000000
```

<p><a href="https://berneti.ir/distance_metrics.html">لینک مخزن گیت‌هاب کدهای این مطلب</a></p>
